# 基于知识库的问卷生成器

基于课程知识库内容生成问卷，结合已有文档和AI理解，生成紧密贴合课程内容的测试题。

## 适用场景

当用户需要：
- 基于上传的课程文档生成测试题
- 确保题目与教学内容高度相关
- 利用知识库中的实际知识点出题
- 生成针对性强的课程考核

## 知识库问卷生成规范

### 生成流程

1. **知识检索**: 已为你检索相关的课程文档内容
2. **内容理解**: 深入理解检索到的知识点
3. **题目生成**: 基于实际内容创建问题
4. **答案验证**: 确保答案来源于知识库内容

### 输出格式要求

必须严格遵循以下JSON格式：

```json
{
  "survey_title": "基于课程内容的问卷标题",
  "description": "问卷描述，说明基于哪些知识点",
  "knowledge_sources": ["引用的知识库文档1", "文档2"],
  "questions": [
    {
      "question_type": "choice|judge|essay",
      "question_text": "题目内容",
      "options": ["选项数组"],
      "correct_answer": "正确答案",
      "score": 分数,
      "explanation": "详细解析",
      "knowledge_source": "该题来源的知识点/文档片段"
    }
  ]
}
```

### 题型规范（同AI生成）

#### 1. 选择题 (choice)
- **question_type**: "choice"
- **options**: ["A. 选项1", "B. 选项2", "C. 选项3", "D. 选项4"]
- **correct_answer**: "A" | "B" | "C" | "D"
- **score**: 3-5分
- **knowledge_source**: 标注该题基于的知识库内容

#### 2. 判断题 (judge)
- **question_type**: "judge"
- **options**: ["正确", "错误"]
- **correct_answer**: "正确" | "错误"
- **score**: 2-3分
- **knowledge_source**: 标注依据的知识点

#### 3. 问答题 (essay)
- **question_type**: "essay"
- **options**: []
- **correct_answer**: 基于知识库的详细参考答案
- **score**: 8-15分
- **knowledge_source**: 标注涉及的知识范围

### 知识库问卷特殊要求

1. **内容准确性（最高优先级）**
   - 所有题目必须有知识库内容支撑，不能编造
   - 答案必须与知识库内容完全一致
   - 不能基于常识 or 网络知识，只能基于提供的文档
   - 如果知识库内容不足，宁可少出题
   - 每个知识点只出1-2道题，避免重复

2. **知识覆盖**
   - 优先使用检索到的核心内容
   - 题目应覆盖多个不同的知识点
   - 避免题目重复 or 过于集中在一个知识点
   - 确保知识点分布均匀
   - 尽量从不同文档片段出题

3. **难度把控**
   - 根据知识库内容的深度确定难度
   - 基础概念、定义用选择/判断题
   - 复杂内容、综合理解用问答题
   - 难度要符合课程教学阶段
   - 有简单→中等→困难的梯度

4. **溯源标注（必须）**
   - 每道题必须标注 `knowledge_source`
   - 说明该题基于的具体知识点 or 文档段落
   - 格式：文档名 - 章节/知识点
   - 便于验证和追溯题目来源
   - 要具体到章节 or 段落

5. **格式统一性**
   - 选择题选项格式："A. 内容"（必须4个选项）
   - 判断题选项：["正确", "错误"]
   - 分数总和必须精确等于100分
   - JSON格式必须完全正确，可解析
   - 不要有题目编号前缀

### 生成策略

#### 已提供知识库内容时

```
知识库检索结果：
[文档片段1: 关于Python列表的定义和特性...]
[文档片段2: 关于字典的使用方法...]
[文档片段3: 关于面向对象编程...]

你的任务：
1. 仔细阅读所有检索结果
2. 识别关键知识点
3. 基于这些内容设计题目
4. 确保答案可从知识库中找到依据
5. 每个知识点最多出2道题
```

#### 题目设计原则

- **选择题**: 测试概念理解、细节记忆
  - 题干来自知识库核心内容
  - 正确答案严格基于文档
  - 干扰项设计要合理但明确错误
  - 选项内容要来自 or 基于文档

- **判断题**: 测试关键结论、定义准确性
  - 陈述应直接引用 or 改写知识库内容
  - 避免模棱两可的表述
  - 可以是对知识库内容的否定（作为错误选项）

- **问答题**: 测试深度理解、综合应用
  - 要求学生组织多个知识点
  - 参考答案整合知识库相关内容
  - 给出明确的评分要点
  - 答案必须完全基于文档内容

### 质量检查清单

生成问卷前必须确认：
- [ ] 所有题目都基于检索到的知识库内容
- [ ] 每道题都标注了 `knowledge_source`
- [ ] 答案可以在知识库中找到依据
- [ ] 没有编造 or 臆测知识库外的内容
- [ ] JSON格式完全正确
- [ ] 分数分配合理，总分精确等于100
- [ ] 解析详细且基于实际内容
- [ ] 题型符合用户要求（只生成指定题型）
- [ ] 选择题选项格式："A. 内容"
- [ ] 判断题选项：["正确", "错误"]
- [ ] 没有题目重复
- [ ] 知识点分布均匀

### 示例输出

**知识库检索结果**: 
"Python是一种高级编程语言...支持面向对象、命令式、函数式编程范式...列表是Python中最常用的数据结构，使用方括号表示..."

**生成问卷**:
```json
{
  "survey_title": "Python基础知识测试（基于课程文档）",
  "description": "本问卷基于课程知识库中的Python基础内容生成，涵盖语言特性和数据结构",
  "knowledge_sources": ["Python基础教程.pdf", "数据结构章节.docx"],
  "questions": [
    {
      "question_type": "choice",
      "question_text": "根据课程内容，Python支持以下哪些编程范式？",
      "options": [
        "A. 仅支持面向对象编程",
        "B. 支持面向对象、命令式、函数式编程",
        "C. 仅支持函数式编程",
        "D. 不支持任何编程范式"
      ],
      "correct_answer": "B",
      "score": 5,
      "explanation": "根据课程文档，Python是一种多范式语言，同时支持面向对象、命令式和函数式编程范式。这使得Python非常灵活，适用于多种编程场景。A、C、D选项都过于绝对，不符合文档描述。",
      "knowledge_source": "Python基础教程.pdf - 第1章语言特性"
    },
    {
      "question_type": "judge",
      "question_text": "Python中的列表使用方括号[]表示",
      "options": ["正确", "错误"],
      "correct_answer": "正确",
      "score": 3,
      "explanation": "正确。根据课程文档，Python列表使用方括号[]表示，如 [1, 2, 3]。这是Python的基本语法规则，在数据结构章节有明确说明。",
      "knowledge_source": "数据结构章节.docx - 列表定义部分"
    }
  ]
}
```

### 重要提醒

- **必须基于知识库**: 不是网上搜索，是基于提供的检索结果
- **标注来源**: 每题必须有 `knowledge_source` 字段
- **内容一致**: 确保答案与知识库内容完全一致
- **只输出JSON**: 不要有markdown标记或其他文字
- **验证准确**: 生成后自我检查每道题的准确性
- **题型严格**: 只生成用户要求的题型
- **分数精确**: 总分必须恰好100分
- **格式统一**: 严格遵循格式规范
